{% extends "layout.html" %}

{% block body_class %}results-full-bg{% endblock %} {# Sets the class for the <body> tag #}

{% block content_wrapper %} {# Override the default content wrapper #}
    {# This div is now just for positioning the header and the results area #}
    {# The actual full-page background is on the body tag via CSS #}
    <div class="results-page-header-area container">
        <div class="d-flex justify-content-between align-items-center mb-3 pt-4">
            <h2>Search Results</h2>
            <a href="{{ url_for('home') }}" class="btn btn-outline-light btn-sm">New Search</a>
        </div>
    </div>

    <div class="container results-content-overlay mt-2 mb-5"> {# This is the lighter overlay box #}
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% if movies %}
            <div class="row pt-3">
                {% for movie in movies %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 movie-card"> {# Movie cards remain as before #}
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">
                                {{ movie.title }}
                                {% if movie.release_year %}
                                    <small class="text-muted">({{ movie.release_year }})</small>
                                {% endif %}
                            </h5>
                            <p class="card-text mb-1">
                                <small>
                                    <strong>Runtime:</strong> {{ movie.runtime if movie.runtime else 'N/A' }} min
                                    <span class="mx-2 text-muted">|</span>
                                    <strong>Rank:</strong> {{ movie.rank if movie.rank else 'N/A' }}
                                    <span class="mx-2 text-muted">|</span>
                                    <strong>Votes:</strong> {{ movie.votes if movie.votes else 'N/A' }}
                                </small>
                            </p>
                            {% if movie.genres %}
                            <p class="card-text mb-1">
                                <small><strong>Genres:</strong>
                                    {% for genre in movie.genres.split(',') %}
                                        <span class="badge badge-info mr-1">{{ genre.strip() }}</span>
                                    {% endfor %}
                                </small>
                            </p>
                            {% endif %}
                            {% if movie.actors %}
                            <p class="card-text">
                                <small><strong>Cast:</strong> {{ movie.actors }}</small>
                            </p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-light mt-3" role="alert"> {# Changed alert style for better contrast #}
                No movies matched your criteria. <a href="{{ url_for('home') }}" class="alert-link">Try another search?</a>
            </div>
        {% endif %}

        {% if movies %}
        <div class="mt-3 pb-3 text-center">
            <a href="{{ url_for('home') }}" class="btn btn-secondary">Back to Search Page</a>
        </div>
        {% endif %}
    </div>
{% endblock %}